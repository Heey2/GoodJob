package com.goodjob;

import java.util.ArrayList;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.NodeList;

import com.goodjob.test.TestDAO;

import lombok.Data;

public class AddInfo {

	public static void main(String[] args) {
		TestDAO dao = new TestDAO();

		ArrayList<Company> list = dao.list();
		
		//ArrayList<Company> result = new ArrayList<>();
		int end= 0;
		try {
			String filePath = "C:\\GoodJob_Heey\\CORPCODE.xml";

			DocumentBuilderFactory dbFactoty = DocumentBuilderFactory.newInstance();
			DocumentBuilder dBuilder = dbFactoty.newDocumentBuilder();

			Document doc = dBuilder.parse(filePath);
			// <list> 태그 가져오기
			NodeList listNodes = doc.getElementsByTagName("list");
			// 각 <list> 태그 안에서 <corp_code>와 <corp_name> 태그 데이터 추출
			for (Company search : list) {
				ArrayList<Company> temp = new ArrayList<>();
				
				for (int i = 0; i < listNodes.getLength(); i++) {
					Element listElement = (Element) listNodes.item(i);
					String corpCode = listElement.getElementsByTagName("corp_code").item(0).getTextContent();
					String corpName = listElement.getElementsByTagName("corp_name").item(0).getTextContent();

					if(!corpName.equals(search.getName()) && corpName.contains(search.getName())) {
						  Company com = new Company(); 
						  com.setCode(corpCode);
						  com.setName(corpName);
						  temp.add(com);
						 
					}
				}
				System.out.println(temp.size());
				
				
				  if(temp.size()==1) { 
					  end = dao.addCode(temp.get(0)); 
					  System.out.println(end);
				  }
				 
			}
		} catch (Exception e) {
			e.printStackTrace();
		}

	}


}
